version: "3.8"

services:
  openclaw-gateway:
    # Use the official image instead of "local"
    image: openclaw/openclaw:latest
    restart: always
    environment:
      - OPENAI_API_KEY=${OPENAI_API_KEY}
      - TELEGRAM_BOT_TOKEN=${TELEGRAM_BOT_TOKEN}
      - CLAWDBOT_GATEWAY_TOKEN=${CLAWDBOT_GATEWAY_TOKEN}
      # Use openai/gpt-4o or your preferred model
      - OPENCLAW_DEFAULT_MODEL=${OPENCLAW_DEFAULT_MODEL:-openai/gpt-4o}
      - TZ=UTC
    networks:
      - dokploy-network
    volumes:
      - openclaw_data:/home/node/.openclaw
      - openclaw_workspace:/home/node/openclaw/workspace
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.openclaw.rule=Host(`claw.undergroundstudio.io`)"
      - "traefik.http.routers.openclaw.entrypoints=websecure"
      - "traefik.http.routers.openclaw.tls.certresolver=letsencrypt"
      - "traefik.http.services.openclaw.loadbalancer.server.port=18789"

networks:
  dokploy-network:
    external: true

volumes:
  openclaw_data:
  openclaw_workspace:
